<!DOCTYPE html>
<html>
  <head>
    <title>Promo Zoom ID - Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta version="v.1.0.1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css" integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous">
<style>

.kontener {
    display: table;
    margin: auto;
}
.body {
    display: table-cell;
    vertical-align: middle;
	width: 500px;
	padding: 20px;
	}

	th, td {
    padding: 3px;
	padding-left: 10px;
	text-align: left; 
    vertical-align: middle;	
	}
.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}

</style>
  </head>
  <body>

<!-- Modal -->
<div class="modal fade" id="sukses" role="dialog" data-backdrop="static" data-keyboard="false" tabindex="-1"
      aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel" id="headerintro">Pelanggan Berhasil Tersimpan</h5>
      </div>
      <div class="modal-body">
        <div class="mb-3">
        Data Pelanggan dengan No. Whatsapp <b><span id="hasilwa"></span></b> berhasil tersimpan
		<textarea class="form-control" id="link" rows="3" readonly></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="selesai()" id="btn1">Oke</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="konfirmasi" role="dialog" data-backdrop="static" data-keyboard="false" tabindex="-1"
      aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel" id="headerintro">Konfirmasi</h5>
      </div>
      <div class="modal-body">
        <div class="mb-3">
        Apakah data yang anda isikan sudah benar?
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn btn-secondary" id="btn1">Tidak</button>
        <button type="button" data-dismiss="modal" class="btn btn-primary" id="btn2" onclick="submit()">Ya, Benar</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="gaklengkap" role="dialog" data-backdrop="static" data-keyboard="false" tabindex="-1"
      aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel" id="headerintro">Data belum lengkap</h5>
      </div>
      <div class="modal-body">
        <div class="mb-3">
        Lengkapi data terlebih dahulu
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn btn-primary">Oke</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="hostkey" role="dialog" data-backdrop="static" data-keyboard="false" tabindex="-1"
      aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Lihat Host Key</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
        Tipe
<table>
<tr><td>
<div class="form-check">
		<input class="form-check-input" type="radio" name="hostkey" id="host100" onclick="pilihHost()">
		<label class="form-check-label" for="host100">
		100
		</label>
	</div></td>
<td>
	<div class="form-check">
		<input class="form-check-input" type="radio" name="hostkey" id="host300" onclick="pilihHost()">
		<label class="form-check-label" for="host300">
		300
		</label>
	</div>
	</td>
<td>
	<div class="form-check">
		<input class="form-check-input" type="radio" name="hostkey" id="host500" onclick="pilihHost()">
		<label class="form-check-label" for="host500">
		500
		</label>
	</div>
	</td>
</tr>
</table>
<div id="dapethost" style="display:none">
    <table>
        <tr><td>Host Key :</td>
        <td><input type="text" class="form-control" id="txthostkey" readonly></td></tr>
        </table>
        </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="btnhost1" onclick="lihathost()" disabled>Cek</button>
        <button id="loadkey" class="btn btn-primary" type="button" style="display : none;" disabled>
  <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
  Processing...
</button>
        <button type="button" data-dismiss="modal" class="btn btn-secondary" id="btnhost2">Oke</button>
      </div>
    </div>
  </div>
</div>

<div class="kontener">
<div class="body">
<h1 style="text-align:center">Sewa Zoom Pro</h1>
  <h3 style="text-align:center">ADMIN</h3>
  <br>

<div align="center"><h4>Tambah Pelanggan</h4></div>
<h6>Nomor <i>Whatsapp</i></h6>
<input id="wa" type="text" class="form-control" placeholder="Contoh : 081234567890"><br>
<h6>Tanggal</h6>
<input id="tgl" type="date" class="form-control" placeholder="Contoh : 2020-08-25"><br>
<div class="row g-3 align-items-center">
  <div class="col-auto" style="width:50%">
	<h6>Jam</h6>
    <input id="jam" type="time" class="form-control" placeholder="Contoh : 15:00"><br>
  </div>
  <div class="col-auto" style="width:50%">
	<h6>Durasi</h6>
	<div class="input-group flex-nowarp">
    <input id="durasi" type="number" class="form-control" placeholder="" min="1" max="24">
	<span class="input-group-text" id="addon-wrapping">Jam</span>
	</div><br>
  </div>
</div>
<h6>Tipe</h6>
<table>
<tr><td>
<div class="form-check">
		<input class="form-check-input" type="radio" name="tipe" id="100" onclick="pilihan()">
		<label class="form-check-label" for="100">
		100
		</label>
	</div></td>
<td>
	<div class="form-check">
		<input class="form-check-input" type="radio" name="tipe" id="300" onclick="pilihan()">
		<label class="form-check-label" for="300">
		300
		</label>
	</div>
	</td>
<td>
	<div class="form-check">
		<input class="form-check-input" type="radio" name="tipe" id="500" onclick="pilihan()">
		<label class="form-check-label" for="500">
		500
		</label>
	</div>
	</td>
</tr>
</table><br>
<div align="center">
<table>
<tr>
<td>
<button type="button" id="next" class="btn btn-primary" onclick="konfirmasi()">Submit</button>
<button id="load" class="btn btn-primari" type="button" style="display : none;" disabled>
  <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
  Processing...
</button></td><td>
<button type="button" id="next" class="btn btn-secondary" onclick="kerekap()">Rekap</button></td><td>
<button type="button" id="host" class="btn btn-secondary" onclick="showHost()">Host Key</button></td>
</tr>
</table>
</div>
<script>
function pilihan() {
if (document.getElementById("100").checked){sessionStorage.setItem("tipe","100")}
else if (document.getElementById("300").checked){sessionStorage.setItem("tipe","300")}
else {sessionStorage.setItem("tipe","500")}
}
function konfirmasi(){
if (document.getElementById("wa").value == "" || document.getElementById("tgl").value == "" || document.getElementById("jam").value == "" || document.getElementById("durasi").value == "" || sessionStorage.getItem("tipe") == null){
var myModal = new bootstrap.Modal(document.getElementById("gaklengkap"), {});
myModal.show();
}
else {
var myModal = new bootstrap.Modal(document.getElementById("konfirmasi"), {backdrop:'static',keyboard:false});
    myModal.show();
    }
}
function submit(){
document.getElementById("load").style.display = "block"
document.getElementById("next").style.display = "none"
var wa = document.getElementById("wa").value.toString()
var tipe = sessionStorage.getItem("tipe")
var tgl = document.getElementById("tgl").value
var jam = document.getElementById("jam").value.toString()
var durasi = parseInt(document.getElementById("durasi").value)
var param = [wa, tipe, tgl,jam,durasi]
fetch("https://script.google.com/macros/s/AKfycbzseDMVrvnQwkFMuMVj4TxF8QyBxbgwMolnIF3UtQ/exec?action=newCustomer&data="+param, {
  'method' : 'get'}).then(function(response) {
    return response.text().then(function(text) {
	document.getElementById("hasilwa").innerText = document.getElementById("wa").value.toString()
	var isilink = konversinomor(document.getElementById("wa").value.toString())
	var el = document.createElement('textarea');
	el.value = "https://promozoomid.github.io/sewazoom?customer="+isilink
	document.getElementById("link").value = el.value
		document.body.appendChild(el);
		el.select();
		document.execCommand('copy');
		document.body.removeChild(el);
	var myModal = new bootstrap.Modal(document.getElementById("sukses"), {});
	myModal.show();
	})})
}
function completed() {
document.getElementById("hasilwa").innerText = document.getElementById("wa").value.toString()
var myModal = new bootstrap.Modal(document.getElementById("sukses"), {});
myModal.show();
}
function selesai(){
sessionStorage.clear()
location.reload();
}
function kerekap() {
location.href = "rekap"
}
function showHost(){
document.getElementById("btnhost2").style.display = "none"
var myModal = new bootstrap.Modal(document.getElementById("hostkey"), {backdrop:'static',keyboard:false});
    myModal.show();
}
function pilihHost() {
document.getElementById("btnhost1").style.display = "block"
document.getElementById("btnhost1").disabled = false
if (document.getElementById("host100").checked){sessionStorage.setItem("host","100")}
else if (document.getElementById("host300").checked){sessionStorage.setItem("host","300")}
else {sessionStorage.setItem("host","500")}
}
function lihathost(){
document.getElementById("host100").disabled = true
document.getElementById("host300").disabled = true
document.getElementById("host500").disabled = true
document.getElementById("loadkey").style.display = "block"
document.getElementById("btnhost1").style.display = "none"
document.getElementById("btnhost2").style.display = "none"
document.getElementById("dapethost").style.display = "none"
var param = sessionStorage.getItem("host")
fetch("https://script.google.com/macros/s/AKfycbzseDMVrvnQwkFMuMVj4TxF8QyBxbgwMolnIF3UtQ/exec?action=carihostkey&data="+param, {
  'method' : 'get'}).then(function(response) {
    return response.text().then(function(e) {
	document.getElementById("txthostkey").value = e
document.getElementById("host100").disabled = false
document.getElementById("host300").disabled = false
document.getElementById("host500").disabled = false
document.getElementById("loadkey").style.display = "none"
document.getElementById("btnhost2").style.display = "block"
document.getElementById("dapethost").style.display = "block"
var el = document.createElement('textarea');
  el.value = "Host Key : "+e
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
	})})
}
function dapethost(e){
document.getElementById("txthostkey").value = e
document.getElementById("host100").disabled = false
document.getElementById("host300").disabled = false
document.getElementById("host500").disabled = false
document.getElementById("loadkey").style.display = "none"
document.getElementById("btnhost2").style.display = "block"
document.getElementById("dapethost").style.display = "block"
var el = document.createElement('textarea');
  el.value = "Host Key : "+e
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
}
function konversinomor(str){
  var res = str.slice(0,1);
  var res2 = str.slice(1,str.length);
  res = res.replace("0","62")
  str = res+res2
  return str
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  </body>
</html>
